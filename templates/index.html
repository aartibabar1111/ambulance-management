<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reliable Ambulance System</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Times New Roman', serif; }
body { 
    background: url('https://www.sciencefriday.com/wp-content/uploads/2017/03/shutterstock_235428334.jpg') no-repeat center center fixed;
    background-size: cover; 
    color: white;
}

/* Navigation */
nav {
    height: 60px; width: 100%; display: flex; align-items: center; padding: 0 20px; 
    position: fixed; top: 0; left: 0; z-index: 10; background-color: rgba(0,0,0,0.6); 
    backdrop-filter: blur(5px);
}
nav a { text-decoration: none; color: white; font-size: 18px; margin-left: 20px; padding: 5px 15px; border-radius: 10px; transition: 0.3s; }
nav a:hover { background-color: orange; color: black; }
#logo { font-size: 30px; margin-right: auto; }

/* Sections */
section { padding: 80px 20px; font-family: 'Times New Roman', serif; }
#main { height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 0 20px; }
#main h1 { font-size: 50px; margin-bottom: 20px; text-shadow: 2px 2px 8px black; }
#main p { font-size: 22px; margin-bottom: 30px; text-shadow: 1px 1px 5px black; }
#bookBtn { padding: 15px 30px; font-size: 20px; background-color: orange; border: none; border-radius: 12px; cursor: pointer; transition: 0.3s; color: white; }
#bookBtn:hover { background-color: white; color: black; }

/* About Section */
.About { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; background-color: rgba(0,0,0,0.7); }
.About .image { width: 400px; height: 400px; background-image: url("https://images.unsplash.com/photo-1588776814546-4ed73fa1df28?auto=format&fit=crop&w=800&q=80"); background-size: cover; border-radius: 20px; margin: 10px; }
.About .info { width: 400px; margin: 10px; }
.About .info h1 { color: orange; margin-bottom: 20px; text-align: center; }
.About .info p { color: white; font-size: 18px; text-align: justify; }
.About .social-media { display: flex; justify-content: center; gap: 20px; margin-top: 20px; }
.About .social-media i { font-size: 30px; cursor: pointer; transition: 0.3s; }
.About .social-media i:hover { color: orange; }

/* Services Section */
.Services { background-color: rgba(0,0,0,0.6); }
.Services h2 { text-align: center; color: orange; margin-bottom: 50px; border-bottom: 3px solid orange; display: inline-block; padding-bottom: 5px; }
.Services .flex { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; }
.Services .card { background-color: rgba(34,34,34,0.8); width: 300px; padding: 20px; border-radius: 15px; transition: 0.3s; }
.Services .card:hover { box-shadow: 0 4px 15px orange; }
.Services .card h3 { margin-bottom: 10px; color: orange; }
.Services .card p { color: white; }

/* Contact Section */
.Contact { background-color: rgba(0,0,0,0.7); }
.Contact h2 { text-align: center; color: orange; margin-bottom: 50px; border-bottom: 3px solid orange; display: inline-block; padding-bottom: 5px; }
.Contact .content { display: flex; flex-wrap: wrap; justify-content: center; gap: 50px; }
.Contact form { background-color: rgba(34,34,34,0.8); padding: 20px; border-radius: 15px; width: 350px; }
.Contact input, .Contact textarea { width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 10px; border: none; }
.Contact button { width: 100%; padding: 12px; border: none; border-radius: 10px; background-color: orange; color: white; cursor: pointer; font-size: 18px; transition: 0.3s; }
.Contact button:hover { background-color: white; color: black; }

/* Footer */
.footer { background-color: rgba(0,0,0,0.8); padding: 20px; text-align: center; }
.footer i { color: orange; font-size: 25px; margin-right: 10px; }

/* Modals */
.modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.8); justify-content: center; align-items: center; }
.modal-content { background: white; padding: 30px; border-radius: 15px; width: 360px; text-align: center; position: relative; }
.modal-content h2 { color: #3e2723; margin-bottom: 20px; }
.modal-content input, .modal-content textarea { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #ccc; font-size: 15px; }
.modal-content button { width: 100%; padding: 12px; background: #6f4e37; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; margin-top: 10px; transition: 0.3s; }
.modal-content button:hover { background: #3e2723; }
.modal-content .close { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; color: #333; }
.modal-content a { color: #6f4e37; text-decoration: none; font-weight: bold; }
.modal-content a:hover { text-decoration: underline; }

/* Booking Panel Table */
#bookingPanel { display: none; position: fixed; top: 70px; left: 50%; transform: translateX(-50%); background: rgba(34,34,34,0.9); padding: 20px; border-radius: 15px; width: 80%; max-width: 900px; color: white; z-index: 99; }
#bookingPanel table { width: 100%; border-collapse: collapse; }
#bookingPanel th, #bookingPanel td { border: 1px solid orange; padding: 10px; text-align: center; }
#bookingPanel th { background-color: orange; color: black; }
#bookingPanel button { padding: 5px 10px; margin: 2px; border: none; border-radius: 6px; cursor: pointer; }
#bookingPanel .updateBtn { background-color: #3e2723; color: white; }
#bookingPanel .deleteBtn { background-color: red; color: white; }

</style>
</head>
<body>

<!-- Navigation -->
<nav>
    <a id="logo" href="#">Reliable Ambulance System</a>
    <a href="#main">Home</a>
    <a href="#about">About</a>
    <a href="#services">Services</a>
    <a href="#contact">Contact</a>
    {% if user %}
        <a href="#" id="panelBtn">{{ user }}'s Panel</a>
        <a href="/logout">Logout</a>
    {% else %}
        <a href="#" id="loginBtn">Login</a>
        <a href="#" id="registerBtn">Register</a>
    {% endif %}
</nav>

<!-- Main Section -->
<section id="main">
    <h1>Reliable Ambulance Management System</h1>
    <p>Fast response, professional care, and safe patient transport whenever you need.</p>
    {% if user %}
        <button id="bookBtn">Book Ambulance</button>
    {% else %}
        <p style="margin-top:20px; color: orange;">Login to book an ambulance.</p>
    {% endif %}
</section>

<!-- About Section -->
<section class="About" id="about">
    <div class="image"></div>
    <div class="info">
        <h1>About Us</h1>
        <p>Our Ambulance Management System ensures that patients receive timely medical assistance with a fleet of professional vehicles and trained staff. We provide 24/7 emergency services, hospital transfers, and medical transport with advanced monitoring systems.</p>
        <div class="social-media">
            <i class="fa-brands fa-instagram"></i>
            <i class="fa-brands fa-facebook"></i>
            <i class="fa-brands fa-x-twitter"></i>
        </div>
    </div>
</section>

<!-- Services Section -->
<section class="Services" id="services">
    <h2>OUR SERVICES</h2>
    <div class="flex">
        <div class="card">
            <h3>Emergency Ambulance</h3>
            <p>Rapid response ambulance service for life-threatening emergencies.</p>
        </div>
        <div class="card">
            <h3>Patient Transport</h3>
            <p>Safe and comfortable non-emergency patient transport to hospitals.</p>
        </div>
        <div class="card">
            <h3>ICU Ambulance</h3>
            <p>Advanced ICU ambulance for critical care patients with monitoring equipment.</p>
        </div>
        <div class="card">
            <h3>Medical Staff Support</h3>
            <p>Trained paramedics and medical staff accompany patients during transport.</p>
        </div>
    </div>
</section>

<!-- Contact Section -->
<section class="Contact" id="contact">
    <h2>Contact Us</h2>
    <div class="content">
        <form action="/contact" method="post">
            <input type="text" name="name" placeholder="Your Name" required>
            <input type="email" name="email" placeholder="Your Email" required>
            <textarea name="message" rows="5" placeholder="Your Message" required></textarea>
            <button type="submit">Send</button>
        </form>
        <div>
            <p><i class="fa-solid fa-location-dot"></i> 123 Main Street, City</p>
            <p><i class="fa-solid fa-phone"></i> 9876543210</p>
            <p><i class="fa-solid fa-envelope"></i> support@ambulance.com</p>
        </div>
    </div>
</section>

<!-- Booking Modal -->
<div id="bookingModal" class="modal">
    <div class="modal-content">
        <span class="close" id="bookingClose">&times;</span>
        <h2>Book Ambulance</h2>
        <form action="/book" method="post">
            <input type="text" name="patient_name" placeholder="Patient Name" required>
            <input type="text" name="pickup_location" placeholder="Pickup Location" required>
            <input type="text" name="destination" placeholder="Destination" required>
            <input type="text" name="contact_number" placeholder="Contact Number" required>
            <button type="submit">Book Now</button>
        </form>
    </div>
</div>

<!-- Booking Panel -->
<div id="bookingPanel">
    <h2>Your Bookings</h2>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Patient</th>
                <th>Pickup</th>
                <th>Destination</th>
                <th>Contact</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for b in bookings %}
            <tr>
                <td>{{ b.id }}</td>
                <td>{{ b.patient_name }}</td>
                <td>{{ b.pickup_location }}</td>
                <td>{{ b.destination }}</td>
                <td>{{ b.contact_number }}</td>
                <td>
                    <button class="updateBtn" onclick="openUpdateModal({{b.id}}, '{{b.patient_name}}', '{{b.pickup_location}}', '{{b.destination}}', '{{b.contact_number}}')">Update</button>
                    <button class="deleteBtn" onclick="deleteBooking({{b.id}})">Delete</button>
                </td>
            </tr>
        {% else %}
            <tr><td colspan="6">No bookings yet.</td></tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<!-- Update Modal -->
<div id="updateModal" class="modal">
    <div class="modal-content">
        <span class="close" id="updateClose">&times;</span>
        <h2>Update Booking</h2>
        <form id="updateForm">
            <input type="hidden" id="update_id">
            <input type="text" id="update_patient_name" placeholder="Patient Name" required>
            <input type="text" id="update_pickup_location" placeholder="Pickup Location" required>
            <input type="text" id="update_destination" placeholder="Destination" required>
            <input type="text" id="update_contact_number" placeholder="Contact Number" required>
            <button type="submit">Update Booking</button>
        </form>
    </div>
</div>

<!-- Login/Register Modals -->
<div id="loginModal" class="modal">
    <div class="modal-content">
        <span class="close" id="loginClose">&times;</span>
        <h2>Login</h2>
        <form action="/login" method="post">
            <input type="email" name="email" placeholder="Email Address" required>
            <input type="password" name="password" placeholder="Password" required>
            <button type="submit">Login</button>
        </form>
        <p>New user? <a href="#" id="switchRegister">Create an account</a></p>
    </div>
</div>
<div id="registerModal" class="modal">
    <div class="modal-content">
        <span class="close" id="registerClose">&times;</span>
        <h2>Register</h2>
        <form action="/register" method="post">
            <input type="text" name="username" placeholder="Username" required>
            <input type="email" name="email" placeholder="Email Address" required>
            <input type="password" name="password" placeholder="Password" required>
            <button type="submit">Register</button>
        </form>
        <p>Already have an account? <a href="#" id="switchLogin">Login</a></p>
    </div>
</div>

<!-- Footer -->
<section class="footer">
    <i class="fa-brands fa-instagram"></i> @ambulanceservice
</section>

<script>
// Modal Handling
const loginModal = document.getElementById('loginModal');
const registerModal = document.getElementById('registerModal');
const bookingModal = document.getElementById('bookingModal');
const bookingPanel = document.getElementById('bookingPanel');
const updateModal = document.getElementById('updateModal');

document.getElementById('loginBtn')?.addEventListener('click', () => loginModal.style.display='flex');
document.getElementById('registerBtn')?.addEventListener('click', () => registerModal.style.display='flex');
document.getElementById('bookBtn')?.addEventListener('click', () => bookingModal.style.display='flex');
document.getElementById('panelBtn')?.addEventListener('click', () => {
    bookingPanel.style.display = bookingPanel.style.display === 'block' ? 'none' : 'block';
});

document.getElementById('loginClose').onclick = () => loginModal.style.display='none';
document.getElementById('registerClose').onclick = () => registerModal.style.display='none';
document.getElementById('bookingClose').onclick = () => bookingModal.style.display='none';
document.getElementById('switchRegister').onclick = () => { loginModal.style.display='none'; registerModal.style.display='flex'; };
document.getElementById('switchLogin').onclick = () => { registerModal.style.display='none'; loginModal.style.display='flex'; };
document.getElementById('updateClose').onclick = () => updateModal.style.display = 'none';
window.onclick = function(event) {
    if(event.target === loginModal) loginModal.style.display='none';
    if(event.target === registerModal) registerModal.style.display='none';
    if(event.target === bookingModal) bookingModal.style.display='none';
    if(event.target === updateModal) updateModal.style.display='none';
};

// Success Alert
window.addEventListener('DOMContentLoaded', () => {
    const urlParams = new URLSearchParams(window.location.search);
    if(urlParams.get('success')==='1') {
        alert('Action completed successfully!');
        window.history.replaceState({}, document.title, "/");
    }
});

// Open Update Modal
function openUpdateModal(id, patient_name, pickup, destination, contact) {
    updateModal.style.display='flex';
    document.getElementById('update_id').value = id;
    document.getElementById('update_patient_name').value = patient_name;
    document.getElementById('update_pickup_location').value = pickup;
    document.getElementById('update_destination').value = destination;
    document.getElementById('update_contact_number').value = contact;
}

// Update Booking AJAX
document.getElementById('updateForm').onsubmit = function(e){
    e.preventDefault();
    const id = document.getElementById('update_id').value;
    fetch('/update_booking/'+id, {
        method:'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify({
            patient_name: document.getElementById('update_patient_name').value,
            pickup_location: document.getElementById('update_pickup_location').value,
            destination: document.getElementById('update_destination').value,
            contact_number: document.getElementById('update_contact_number').value
        })
    }).then(res => {
        if(res.status === 204){
            alert('Booking updated successfully!');
            window.location.reload();
        } else { alert('Update failed!'); }
    });
}

// Delete Booking
function deleteBooking(id){
    if(confirm('Are you sure you want to delete this booking?')){
        fetch('/delete_booking/'+id, { method:'POST' }).then(res => {
            if(res.status === 204){ window.location.reload(); }
            else { alert('Delete failed!'); }
        });
    }
}
</script>
</body>
</html>
